library(pracma)
library(ggplot2)
library(Rmpfr)
library(PolynomF)

horas=c(100,200,300,400,500,600,700,800,900,1000,1100,
        1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,2300,2400,2500,2600,2700,2800,2900,3000,3100,
        3200,3300,3400,3500,3600,3700,3800,3900,4000,4100,4200,4300,4400,4500,4600,4700,4800,4900,5000,5100,
        5200,5300,5400,5500,5600,5700,5800,5900,6000,6100,6200,6300,6400,6500,6600,6700,6800,6900,7000,
        7100,7200,7300,7400,7500,7600,7700,7800,7900,8000,8100,8200,8300,8400,8500,8600,8700,8800,8900,9000,
        9100,9200,9300,9400,9500,9600,9700,9800,9900,10000,10100,10200,10300,10400,10500,10600,10700,10800,
        10900,11000,11100,11200,11300,11400,11500,11600,11700,11800,11900,12000,12100,12200,12300,12400,12500,
        12600,12700,12800,12900,13000,13100,13200,13300,13400,13500,13600,13700,14200,14300,14400,14500,14600,
        14700,14800,14900,15000,15100,15200,15300,15400,15500,15600,15700,15800,15900,16000,16100,16200,16300,
        16400,16500,16600,16700,16800,16900,17000,17100,17200,17300,17400,17500,17600,17700,17800,17900,18000,
        18100,18200,18300,18400,18500,18600,18700,18800,18900,19000,19100,19200,19300,19400,19500,19600,19700,
        19800,19900,20000,20100,20200,20300,20400,20500,20600,20700,20800,20900,21000,21100,21200,21300,21400,
        21500,21600,21700,21800,21900,22000,22100,22200,22300,22400,22500,22600,22700,22800,22900,23000,23100,
        23200,23300,23400,23500,23600,23700,23800,23900,24000,24100,24200,24300,24400,24500,24600,24700,24800,
        24900,25000,25100,25200,25300,25400,25500,25600,25700,25800,25900,26000,26100,26200,26300,26400,26500,
        26600,26700,26800,26900,27000,27100,27200,27300,27400,27500,27600,27700,27800,27900,28000,28100,28200,
        28300,28400,28500,28600,28700,28800,28900,29000,29100,29200,29300,29400,29500,29600,29700,29800,29900,
        30000,30100,30200,30300,30900,31000,31100,31200,31300,31400,31500,31600,31700,31800,31900,32000,32100,
        32200,32300,32400,32500,32600,32700,32800,32900,33000,33100,33200,33300,33400,33500,33600,33700,33800,
        33900,34000,34100,34200,34300,34400,34500,34600,34700,34800,34900,35000,35100,35200,35300,35400,35500,
        35600,35700,35800,35900,36000,36100,36200,36300,36400,36500,36600,36700,36800,36900,37000,37100,37200,
        37300,37400,37500,37600,37700,37800,37900,38000,38100,38200,38300,38400,38500,38600,38700,38800,38900,
        39000,39100,39200,39300,39400,39500,39600,39700,39800,39900,40000,40100,40200,40300,40400,40500,40600,
        40700,40800,40900,41000,41100,41200,41300,41400,41500,41600,41700,41800,41900,42000,42100,42200,42300,
        42400,42500,42600,42700,42800,42900,43000,43100,43200,43300,43400,43500,43600,43700,43800,43900,44000,
        44100,44200,44300,44400,44500,44600,44700,44800,44900,45000,45100,45200,45300,45400,45500,45600,45700,
        45800,45900,46000,46100,46200,46300,46400,46500,46600,46700,46800,46900,47000,47100,47200,47300,47400,
        47500,47600,47700,47800,47900,48000,48100,48200,48300,48400,48500,48600,48700,48800,48900,49000,49100,
        49200,49300,49400,49500,49600,49700,49800,49900,50000,50100,50200,50300,50400,50500,50600,50700,50800,
        50900,51000,51100,51200,51300,51400,51500,51600,51700,51800,51900,52000,52100,52200,52300,52400,52500,
        52600,52700,52800,52900,53000,53100,53200,53300,53400,53500,53600,53700,53800,53900,54000,54100,54200,
        54300,54400,54500,54600,54700,54800,54900,55000,55100,55200,55300,55400,55500,55900,56000,56100,56200,
        56300,56400,56500,56600,56700,56800,56900,57000,57100,57200,57300,57400,57500,57600,57700,57800,57900,
        58000,58100,58200,58300,58400,58500,58600,58700,58800,58900,59000,59100,59200,59300,59400,59500,59600,
        59700,59800,59900,60000,60100,60200,60300,60400,60500,60600,60700,60800,60900,61000,61100,61200,61300,
        61400,61500,61600,61700,61800,61900,62000,62100,62200,62300,62400,62500,62600,62700,62800,62900,63000,
        63100,63200,63300,63400,63500,63600,63700,63800,63900,64000,64100,64200,64300,64400,64500,64600,64700,
        64800,64900,65000,65100,65200,65300,65400,65500,65600,65700,65800,65900,66000,66100,66200,66300,66400,
        66500,67100,67200,67300,67400,67500,67600,67700,67800,67900,68000,68100,68200,68300,68400,68500,68600,
        68700,68800,68900,69000,69100,69200,69300,69400,69500,69600,69700,69800,69900,70000,70100,70200,70300,
        70400,70500,70600,70700,70800,70900,71000,71100,71200,71300,71400,71500,71600,71700,71800,71900,72000)

temp=c(27.94,27.44	,26.84	,26.69	,26.82	,26.33	,28.14	,30.51	,34.11	,35.78	,37.22	,
       36.8,38.43,39.04	,39.26	,38.96	,36.34	,31.05	,28.78	,27.98	,27.52	,27.13	,26.98	,26.9	,
       26.73,26.6,26.81	,26.64	,26.47	,26.65	,27.75	,29.92	,32.7	,33.92	,26.71	,33.57	,34.41	,
       34.92,35.23,36.94	,34.33	,29.58	,27.92	,27.38	,26.74	,26.65	,26.38	,25.89	,25.21	,24.47	,
       24.9,24.85,24.79	,24.04	,27.13	,32.44	,33.4	,33.62	,35.93	,36.16	,38.08	,39.22	,39.98	,
       39.2,36.43,30.75	,28.37	,27.58	,27.19	,26.91	,26.88	,26.92	,26.64	,26.43	,26.01	,25.34	,
       25.41,25.17,26.53	,30.62	,34.25	,35.02	,29.18	,27.95	,30.8	,29.79	,30.83	,33.33	,31.44	,
       28.21,26.43,25.45	,25.06	,24.81	,25.04	,24.81	,24.85	,24.31	,23.88	,23.63	,23.5	,
       23.7,25.91,29.53	,34.69	,33.96	,33.56	,34.62	,35.64	,36.73	,38.42	,37.01	,32.91	,29.09	,
       27.7,27.31,27.03	,26.37	,25.85	,25.01	,24.78	,24.77	,24.73	,24.88	,25.13	,25.12	,27.85	,
       32.32,34.67,36.32	,36.35	,36.41	,37.86	,39.07	,39.29	,37.91	,36.29	,27.7	,27.42	,27.17	,
       26.86,26.84,26.06	,25.08	,24.7	,24.43	,29.11	,33.78	,36	,37.22	,36.5	,36.64	,38.67	,39.95	,
       40.4,39.79,37.6	,31.3	,28.46	,27.42	,26.89	,26.55	,26.63	,26.74	,26.57	,25.91	,25.57	,
       25.72,25.64,25.61	,26.13	,28.55	,28.83	,31.17	,31.7	,28.69	,34.96	,35.91	,37.86	,37.12	,
       32.58,29.72,27.77	,26.95	,26.63	,26.26	,25.65	,25.39	,25.15	,25.15	,24.53	,24.43	,24.19	,
       23.98,25.44,31.69	,34.3	,35.1	,35.4	,35.86	,37.61	,36.11	,35.64	,35.84	,34.31	,29.93	,
       28.19,27.67,27.41	,27.22	,27.02	,26.64	,26.3	,25.76	,25.56	,25.04	,24.76	,24.59	,27.61	,
       32.7,35.01,34.5	,35.62	,37.36	,37.46	,35.25	,32.99	,32	,30.5	,29.17	,28.29	,27.77	,27.68	,
       27.61,27.15,27.19	,27.13	,27	,26.88	,26.66	,25.37	,24.79	,27.67	,31.92	,34.58	,35.65,36.27,
       36.5,38.15,39.16	,39.6	,39.17	,37.13	,31.49	,29	,28.37	,27.87	,27.56	,27.07	,27.02	,
       26.99,26.98,26.6	,26.13	,25.29	,24.94	,26.28	,31.83	,34.47	,35.17	,35.64	,36.11	,37.15	,
       38.24,39.01,38.74	,36.91	,31.19	,28.47	,27.83	,27.54	,27.59	,27.27	,27.09	,26.82	,26.58	,
       26.36,26.3,25.37	,24.49	,28.59	,33.42	,33.92	,36.08	,36.03	,37.1	,38.13	,38.72	,38.06	,
       27.04,26.58,26.12	,25.59	,24.74	,24	,24.02	,23.53	,23.19	,23.23	,26.55	,32.89	,34.86	,
       35.98,37.5,38.15	,39.23	,39.99	,39.99	,39.23	,36.8	,31.1	,28.32	,27.36	,26.78	,26.64	,
       26.83,26.74,26.67	,26.42	,25.76	,25.06	,24.61	,24.31	,25.95	,33.2	,35	,36.9	,37.34	,38.25	,
       38.83,39.45,39.63	,37.33	,31.96	,29.96	,29.01	,28.35	,28.04	,27.82	,27.53	,27.38	,
       27.03,26.96,27.02	,26.55	,26.05	,25.63	,30.18	,33.62	,35.93	,37.53	,36.54	,37.49	,39.5	,
       40.49,37.72,39.36	,36.03	,31.2	,29.2	,28.52	,28.33	,28.03	,27.71	,27.27	,26.74	,26.55	,
       26.06,25.58,25.3	,25.13	,26.52	,34.19	,34.54	,36.98	,37.49	,38.52	,36.55	,40.41	,40.37	,
       35.28,31.67,29.48	,28.36	,27.86	,27.6	,27.47	,27.23	,26.96	,26.58	,26.42	,25.87	,25.43	,
       25.24,25.24,27.31	,27.94	,31.1	,32.64	,31.11	,32.9	,33.93	,31.74	,33.27	,32.77	,30.63	,28.7	,
       27.64,27.21,26.94	,26.7	,26.68	,26.4	,25.73	,24.43	,24.29	,24.25	,23.91	,23.87	,25.21	,
       27.01,30.31,35.26	,33.12	,35.47	,38.77	,38.97	,34.23	,32.2	,30.71	,28.97	,27.92	,27.38	,
       27.24,27.34,27.25	,25.78	,25.59	,24.83	,23.57	,23.19	,23.17	,23.23	,23.48	,27.29	,29.04	,
       31.77,35.67,37.08	,38.97	,38.7	,36.8	,35.49	,33.14	,29.23	,27.07	,26.34	,25.82	,25.29	,
       24.99,24.51,24.51	,24.16	,23.88	,23.63	,23.62	,23.32	,24.93	,27.19	,28.84	,33.4	,36	,
       36.07,36.05,38.61	,39.24	,38.97	,36.4	,30.72	,28.16	,27.11	,26.13	,
       25.39,25.03,24.68	,24.5	,24.54	,24.58	,24.5	,24.55	,24.19	,24.68	,28.79	,34.97	,35.61	,
       33.64,36.29,36.63	,39.21	,37.43	,36.57	,32.88	,29.63	,27.73	,26.8	,26.31	,26.29	,25.86	,
       25.07,24.64,24.19	,23.7	,23.66	,23.54	,23.35	,23.74	,26.56	,31.45	,33.81	,34.83	,35.62	,
       36.36,36.79,37.34	,32.55	,30.69	,28.77	,26.42	,25.43	,24.63	,24.27	,23.77	,23.64	,24	,24	,
       24.09,23.43,24.75	,29.5	,29.43	,29.07	,30.57	,30.38	,29.76	,30.59	,32.71	,31.37	,27.79	,
       26.17,25.34,24.82	,24.63	,24.72	,24.74	,24.56	,24.3	,24.16	,24.05	,23.87	,23.97	,27.18	,
       31.47,33.86,35.3	,35.31	,36.46	,36.23	,36.75	,38.18	,35.71	,32.49	,29.17	,27.7	,26.88	,
       25.91,25.63,25.38	,24.98	,25.01	,24.85	,24.51	,24.15	,23.83	,23.78	,25.28	,30.59	,34.5	,
       35.02,35.86,36.9	,37.26	,38.09	,38.45	,38	,35.14	,30.22	,28.29	,27.64	,27.78	,27.71	,27.01	,
       25.95,25.67,25.32	,25.37	,24.74	,24.47	,24.18	,28.07	,32.31	,35.15	,36.3	,35.72	,37.04	,
       37.8,38.3,39.18	,39.03	,36.06	,30.57	,28.73	,28.11	,27.81	,27.6	,27.22	,26.77	,25.93	,
       25.43,25.4,25.16	,24.93	,25.02	,29.14	,32.57	,34.84	,35.84	,37.24	,34.74	,32.57	,33.22	,
       35.26,32.76,29.43	,25.6	,25.73	,25.93	,25.66	,25.11	,24.75	,24.46	,24.19	,24.82	,25.81	,
       26.34,27.21,32.54	,33.79	,36.8	,38.01	,39.2	,38.44	,35.02	,29.51	,27.96	,27.35	,26.62	,
       25.88,25.3,24.95	,24.89	,24.91	,24.68	,24.43	,24.29	,24.28	,24.85	,25.95	,25.7	,24.72	,
       24.56,24.34,26.34	,29.68	,32	,30.4	,29.35	,27.37	,26.5	,25.88	,25.41	,25.3	,25.32	,25.2	)

indice=sample(1:length(horas), 0.8*length(horas) , replace = FALSE)
sr=sort(indice)
x=horas[sr]
y=temp[sr]
#print(sr)

cs=cubicspline(x,y,horas)
hermite=pchip(x,y,horas)
#lagrangeInterp(x,y, horas)


#plot(horas,lagrange,"l",col="Blue", ylab="temperatura")
plot(horas,cs,"l",col="Blue", ylab="temperatura")
lines(horas,hermite,"l",col="Green")
lines(horas,temp,col="Red")

errores <- function(v, enc){
  i = 1
  valoresEncontrados = enc
  valoresTeo = v
  media = 0
  errorRel = 0
  total = 0
  errorAbs = 0
  maxRel = 0
  vec = vector(length = length(enc))
  
  while(i <= length(enc)){
    #Calculo error relativo
    errorRel = abs(valoresEncontrados[i]-valoresTeo[i])/valoresTeo[i]
    
    #Calculo error absoluto
    errorAbs = abs(valoresEncontrados[i]-valoresTeo[i])
    vec[i] = errorAbs
    
    total = total + errorAbs
    #cat(i,": ",errorAbs)
    #cat("\n")
    i = i + 1
  }
  
  media = total/length(enc)
  cat("Media de error absoluto es ",media,"\n")
  cat("Error minimo absoluto es ",min(vec),"\n")
  cat("Error maximo absoluto es ",max(vec),"\n")
  
}

jaccardIndex <- function(A,B){
  #cat("\n")
  cat("Indice de jaccard es ",length(intersect(A,B))/length(union(A,B)))
}


indiceCompleto = sort(sample(1:length(horas), length(horas) , replace = FALSE))
indeEnc = setdiff(indiceCompleto, sr)
v = temp[indeEnc]

print("Errores de Cubic Spline")
encontrados = cs[indeEnc]
errores(v, encontrados)
jaccardIndex(temp,cs)
cat("\n")
print("Errores de Hermite")
encontrados1 = hermite[indeEnc]
errores(v, encontrados1)
jaccardIndex(temp,hermite)